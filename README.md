# **<center>数字语音处理课程设计（项目一、项目二）</center>**
# 项目一 语音信号时域及频谱分析

## 1. 实验目的

1. 掌握语音采集、存储、回放的方法；
2. 掌握语音信号短时分析的原因；
3. 掌握语音短时能量、短时自相关分析的方法；
4. 掌握语音短时傅里叶分析的方法。

## 2. 实验原理

### 2.1 语音信号的时域特点

语音信号是一种典型的非平稳时变信号，其统计特性随时间不断变化。然而，在较短的时间间隔内（通常为 10–30 ms），语音信号可以近似视为平稳过程，这为采用短时分析方法处理语音信号提供了理论基础。

语音主要由清音和浊音构成：
- **浊音**：在时域上呈现出明显的准周期性，其波形具有较强的相关性
- **清音**：类似于随机噪声，波形无明显周期性，过零率较高

此外，语音信号的能量随时间变化显著，不同音素、音节之间能量存在明显差异。

### 2.2 语音信号的短时分析原理

由于语音信号的非平稳特性，传统的傅里叶分析难以直接适用。因此，通常采用"短时分析"方法，即通过一个滑动的有限长度窗口对语音信号进行分段，并假设每帧信号是平稳的，进而分别对每一帧进行分析。

- **常用窗函数**：汉明窗、汉宁窗等，其中汉明窗因具有较低的旁瓣泄漏，在语音处理中应用广泛
- **窗长**：一般设为 10–30 ms
- **窗移（帧移）**：通常为窗长的一半，例如 10 ms，以保证帧间平滑过渡

### 2.3 加窗分帧

加窗分帧是语音短时分析的基础步骤。设语音信号为 $x(n)$，窗函数为 $w(n)$，则第 $m$ 帧语音信号可表示为：

$$x_m(n) = x(n + mR) \cdot w(n)$$

其中 $R$ 为帧移，采用汉明窗。

### 2.4 短时能量分析

短时能量用于分析一帧语音信号的强度，反映语音的幅度变化，常用于端点检测和清浊音判断。第 $m$ 帧的短时能量定义为：

$$E_m = \sum_{n=0}^{L-1} x_m^2(n)$$

浊音段通常具有较高的短时能量，而清音段能量较低。

### 2.5 短时自相关分析

短时自相关函数用于分析语音信号的周期性，常用于基音周期估计。第 $m$ 帧的短时自相关函数定义为：

$$R_m(k) = \sum_{n=0}^{L-1-k} x_m(n) \cdot x_m(n+k)$$

其中 $k$ 为延迟点数。对于浊音帧，自相关函数会在基音周期整数倍位置出现峰值，通过检测最大峰值位置可估计基音周期。

### 2.6 短时傅里叶分析

短时傅里叶分析（STFT）是语音频域分析的基本方法，通过对每帧信号进行傅里叶变换，得到语音的时变频谱。第 $m$ 帧的短时傅里叶变换为：

$$X_m(e^{j\omega}) = \sum_{n=0}^{L-1} x_m(n) \cdot e^{-j\omega n}$$

在实际应用中常采用快速傅里叶变换（FFT）进行计算。为更清晰地分析共振峰结构，常使用对数幅度谱：

$$X_{m,db}(\omega) = 20\log_{10}|X_m(e^{j\omega})|$$

对数谱能够增强共振峰的可见性，有助于估计共振峰频率和基频分布。

## 3. 实验内容

### 3.1 语音录制
### 3.2 加窗分帧处理
### 3.3 短时能量分析
### 3.4 短时自相关分析
### 3.5 短时傅里叶分析
# 项目二 语音信号的线性预测分析

## 1. 实验目的

1. 掌握语音信号线性预测分析的原理和方法；
2. 掌握语音信号线性预测系数检测共振峰的原理和方法；
3. 掌握语音信号线性预测误差检测基音频率的原理和方法；

## 2. 实验原理

线性预测分析是现代语音信号处理中的核心技术。其基本思想是：一个语音的采样值可以用过去若干个语音采样值的线性组合来预测。通过使实际采样值与线性预测值之间的误差在最小均方意义上最小化，可以求解出一组唯一的预测系数，这组系数构成了一个全极点模型，能够精确地描述语音信号的频谱包络。

### 2.1 线性预测的基本模型

#### （1）全极点模型

线性预测分析将声道视为一个时变的、由冲激序列（浊音）或随机噪声（清音）激励的全极点滤波器。该系统的传递函数定义为：

$$H(z) = \frac{G}{1 - \sum_{i=1}^{p} a_i z^{-i}} = \frac{G}{A(z)}$$

其中：
- $p$ 为预测器阶数，决定了模型的复杂度
- $a_i$ 为线性预测系数，模型的核心参数，反映了声道的共振特性
- $G$ 为增益因子，与控制激励信号的幅度有关
- $A(z)$ 为逆滤波器

#### （2）线性预测与残差

根据模型，当前时刻的语音采样值 $s(n)$ 可以被预测为前 $p$ 个采样值的线性组合：

$$\hat{s}(n) = \sum_{i=1}^{p} a_i s(n-i)$$

预测值与实际值之间的差值为预测误差或残差：

$$e(n) = s(n) - \hat{s}(n) = s(n) - \sum_{i=1}^{p} a_i s(n-i)$$

从系统角度看，原始语音信号是通过将激励信号输入到系统 $H(z)$ 产生的输出。因此，残差被认为是去除了声道影响后的激励源的近似。

#### （3）预测器阶数 p 的选择

预测器的阶数由采样率和需要观察的共振峰个数及采样率来决定：

$$p = \frac{f_s}{1000} + 3 \sim 5$$

### 2.2 线性预测系数与频谱包络

LPC 系数描述了声道滤波器的特性。对该滤波器进行傅里叶变换，即可得到信号的 LPC 谱或频谱包络：

$$H(e^{j\omega}) = \frac{G}{|1 - \sum_{i=1}^{p} a_i e^{-j\omega i}|}$$

这条谱线平滑地通过了原始语音频谱的共振峰峰值，因此通过检测该包络的峰值，可以有效地提取出共振峰频率和带宽，这是分析声道特性的关键。

### 2.3 预测误差与基音检测

残差信号近似于声门的激励。在浊音段，声门激励是准周期的，因此在残差信号中会呈现出周期性的冲激。对残差信号进行自相关分析，可以在基音周期位置出现明显的峰值。由于残差信号已很大程度上消除了声道共振的影响，其周期性比原始语音信号更显著，使得基音周期的检测更加精确和鲁棒。在清音段，残差信号类似于白噪声，其自相关函数没有周期性峰值。

## 3. 实验内容
### 3.1、在项目一语音的基础之上，分别对浊音帧和清音帧进行P=18阶的线性预测处理
### 3.2、分别显示浊音帧和清音帧的原始语音、预测语音和预测误差波形，并对预测误差进行自相关处理
### 3.3、分别对浊音帧和清音帧的预测系数进行1024点的傅里叶变换，得到预测系数谱
